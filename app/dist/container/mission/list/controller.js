define(["adminApp","moment","ap-charts"],function(s,i){s.controller("MissionListController",["api","messageBox",function(s,t){function e(s,i){i.id=s.id,i.title=s.title,i.content=s.content,i.createDate=s.createDate,i.startDate=s.startDate,i.endDate=s.endDate,i.status=s.status,i.author=s.author,i.type=s.type,i.reaper=s.reaper}function n(){o.selectMission=void 0,o.showAction=!1,o.mission={}}var o=this;o.moment=i,o.selectMission,o.mission={show:!1},o.newMission={},o.showCreate=!1,o.showAction=!1,o.missionList=[],o.toCreateMission=function(){o.showCreate=!0},o.toDeleteMission=function(){var i=o.selectMission.id;s.missionDelete(i,function(s){if(200==s.code){n();for(var e=o.missionList.length-1;e>=0;e--){var a=o.missionList[e];a.id==i&&o.missionList.splice(e,1)}t("success","Delete Mission Successful!")}else t("error","Delete Mission Successful!")})},s.missionList(function(s){angular.forEach(s,function(s){this.push(s)},o.missionList)}),o.submitNewMission=function(){var n=parseInt(i().format("x"));o.newMission.createDate=n;var a=parseInt(i(o.newMission.startDate).format("x")),c=parseInt(i(o.newMission.endDate).format("x"));o.newMission.startDate=a?a:n,o.newMission.endDate=c?c:n;var r={};e(o.newMission,r),r.type="mission",r.author="Quesle",s.missionAdd(r,function(s){o.missionList.unshift(s),o.cancelNewMission(),t("success","Create Mission Successful!")})},o.cancelNewMission=function(){o.newMission={},o.showCreate=!1},o.showMissionItem=function(s){n(),o.selectMission=s,e(s,o.mission),o.mission.show=!0},o.complateMission=function(){var i={};e(o.selectMission,i),i.status="complate",s.missionUpdate(i,function(){o.selectMission.status="complate",o.mission.status="complate"})}}])});