define(["adminApp","moment"],function(s,i){s.controller("TaskDetailController",["api","messageBox","breadcrumb",function(s,t,e){function n(s,i){i.id=s.id,i.title=s.title,i.content=s.content,i.createDate=s.createDate,i.startDate=s.startDate,i.endDate=s.endDate,i.status=s.status,i.author=s.author,i.type=s.type,i.reaper=s.reaper}function o(){a.selectMission=void 0,a.showAction=!1,a.mission={}}e("Task Detail",[{name:"Task",link:"main.task.list"},{name:"Detail",link:"main.task.list"}]);var a=this;a.moment=i,a.selectMission,a.mission={show:!1},a.newMission={},a.showCreate=!1,a.showAction=!1,a.missionList=[],a.toCreateMission=function(){a.showCreate=!0},a.toDeleteMission=function(){var i=a.selectMission.id;s.missionDelete(i,function(s){if(200==s.code){o();for(var e=a.missionList.length-1;e>=0;e--){var n=a.missionList[e];n.id==i&&a.missionList.splice(e,1)}t("success","Delete Mission Successful!")}else t("error","Delete Mission Failure!")})},s.missionList(function(s){angular.forEach(s,function(s){this.push(s)},a.missionList)}),a.submitNewMission=function(){var e=parseInt(i().format("x"));a.newMission.createDate=e;var o=parseInt(i(a.newMission.startDate).format("x")),c=parseInt(i(a.newMission.endDate).format("x"));a.newMission.startDate=o?o:e,a.newMission.endDate=c?c:e;var u={};n(a.newMission,u),u.type="mission",u.author="Quesle",s.missionAdd(u,function(s){a.missionList.unshift(s),a.cancelNewMission(),t("success","Create Mission Successful!")})},a.cancelNewMission=function(){a.newMission={},a.showCreate=!1},a.showMissionItem=function(s){o(),a.selectMission=s,n(s,a.mission),a.mission.show=!0},a.complateMission=function(){var i={};n(a.selectMission,i),i.status="complate",s.missionUpdate(i,function(){a.selectMission.status="complate",a.mission.status="complate",t("success","Complate Mission Successful!")})},a.unComplateMission=function(){var i={};n(a.selectMission,i),i.status="uncomplate",s.missionUpdate(i,function(){a.selectMission.status="uncomplate",a.mission.status="uncomplate",t("success","UnComplate Mission Successful!")})}}])});