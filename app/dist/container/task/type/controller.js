define(["adminApp"],function(e){e.controller("TaskMediaTypeController",["breadcrumb","api",function(e,a){function t(){a.category.get(function(e){e&&e.data&&(n.categories.length=0,angular.forEach(e.data,function(e){this.push(e)},n.categories))})}function o(e,a){for(var t=e.length-1;t>=0;t--)e[t].id===a.id&&e.splice(t,1)}function r(){n.newLabel="",n.newCategory=""}e("Media Type",[{name:"Task",link:"main.task.detail"},{name:"Media Type",link:"main.task.type"}]);var l={Category1:["Label1","Label2","Label3","Label4"],Category2:["bel1","bel2","bel3","bel4"]},n=this;n.select="Category",n.isCreate=!1,n.categories=[],n.categoryLabels=[],n.newCategory="",n.newLabel="",n.selectCategoryIdForLabel="",n.selectCategoryForLabel={},n.selectCategory=function(){n.select="Category",n.isCreate=!1,r()},n.selectLabel=function(){n.select="Label",n.isCreate=!1,!n.selectCategoryIdForLabel&&n.categories.length>0&&(n.selectCategoryForLabel=n.categories[0],n.selectCategoryIdForLabel=n.selectCategoryForLabel.id,n.changeCategoryForLabel()),r()},n.createNewCategory=function(){n.isCreate=!0},n.createNewLabel=function(){n.isCreate=!0},n.cancelCreateCategory=function(){n.isCreate=!1},n.cancelCreateLabel=function(){n.isCreate=!1},n.toCreateNewCategory=function(){var e=n.categories.indexOf(n.newCategory);""!==n.newCategory&&e===-1&&a.category.post({value:n.newCategory},function(e){n.categories.push(e.data)}),r(),n.isCreate=!1},n.toCreateNewLabel=function(){n.selectCategoryIdForLabel&&n.newLabel&&(n.getLabelByValue(n.newLabel)||a.label.post({categoryId:n.selectCategoryForLabel.id,category:n.selectCategoryForLabel.value,value:n.newLabel},function(){n.categoryLabels.push(n.newLabel),n.changeCategoryForLabel(),r(),n.isCreate=!1}))},n.changeCategoryForLabel=function(){n.selectCategoryIdForLabel&&(n.selectCategoryForLabel=n.getCagetoryById(n.selectCategoryIdForLabel),a.label.get(n.selectCategoryForLabel.id,function(e){n.categoryLabels.length=0,angular.forEach(e.data,function(e){this.push(e)},n.categoryLabels)}))},n.deleteCategory=function(e){delete l[e],a.category["delete"](e.id,function(a){a&&200===a.code&&(e.id===n.selectCategoryIdForLabel&&(n.categoryLabels.length=0,n.selectCategoryIdForLabel=""),o(n.categories,e))})},n.deleteLabelForCategory=function(e){a.label["delete"](e.id,function(a){a&&200===a.code&&o(n.categoryLabels,e)}),n.changeCategoryForLabel()},n.getCagetoryById=function(e){for(var a in n.categories){var t=n.categories[a];if(t.id===e)return t}},n.getLabelByValue=function(e){for(var a in n.categoryLabels){var t=n.categoryLabels[a];if(t.value===e)return t}},t()}])});