define(["adminApp","moment","ap-charts"],function(s,i){s.controller("MissionListController",["api","messageBox","breadcrumb",function(s,e,t){function n(s,i){i.id=s.id,i.title=s.title,i.content=s.content,i.createDate=s.createDate,i.startDate=s.startDate,i.endDate=s.endDate,i.status=s.status,i.author=s.author,i.type=s.type,i.reaper=s.reaper}function o(){a.selectMission=void 0,a.showAction=!1,a.mission={}}t("Task Detail",[{name:"Task",link:"main.task.list"},{name:"Detail",link:"main.task.list"}]);var a=this;a.moment=i,a.selectMission,a.mission={show:!1},a.newMission={},a.showCreate=!1,a.showAction=!1,a.missionList=[],a.toCreateMission=function(){a.showCreate=!0},a.toDeleteMission=function(){var i=a.selectMission.id;s.missionDelete(i,function(s){if(200==s.code){o();for(var t=a.missionList.length-1;t>=0;t--){var n=a.missionList[t];n.id==i&&a.missionList.splice(t,1)}e("success","Delete Mission Successful!")}else e("error","Delete Mission Failure!")})},s.missionList(function(s){angular.forEach(s,function(s){this.push(s)},a.missionList)}),a.submitNewMission=function(){var t=parseInt(i().format("x"));a.newMission.createDate=t;var o=parseInt(i(a.newMission.startDate).format("x")),c=parseInt(i(a.newMission.endDate).format("x"));a.newMission.startDate=o?o:t,a.newMission.endDate=c?c:t;var r={};n(a.newMission,r),r.type="mission",r.author="Quesle",s.missionAdd(r,function(s){a.missionList.unshift(s),a.cancelNewMission(),e("success","Create Mission Successful!")})},a.cancelNewMission=function(){a.newMission={},a.showCreate=!1},a.showMissionItem=function(s){o(),a.selectMission=s,n(s,a.mission),a.mission.show=!0},a.complateMission=function(){var i={};n(a.selectMission,i),i.status="complate",s.missionUpdate(i,function(){a.selectMission.status="complate",a.mission.status="complate",e("success","Complate Mission Successful!")})}}])});