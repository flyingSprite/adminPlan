define(["adminApp"],function(t){t.controller("DocsWikiController",["$state","$stateParams","breadcrumb","api","copyArray","removeArrayById",function(t,e,n,o,i,c){function d(){l.id=e.id,o.doc.getSubjectById(l.id,function(t){console.log(t),t&&200===t.code&&t.data&&(l.docSubject=t.data)}),o.doc.getTitle(l.id,function(t){console.log(t),t&&200===t.code&&t.data&&(l.titles.lenght=0,i(l.titles,t.data))})}n("Wiki",[{name:"Document",link:"main.docs.subject"},{name:"Wiki",link:"main.docs.wiki"}]);var l=this;l.titles=[],l.selectTitle={},l.docContent={},l.hasDocContent=!1,l.isEditDocContent=!1,l.editorOptions={lineWrapping:!0,lineNumbers:!0,mode:"markdown"},l.toCreateNewTitle=function(){l.newTitle&&l.id&&o.doc.postTitle({subjectId:l.id,title:l.newTitle,author:"Quesle"},function(t){t&&200===t.code&&t.data&&(l.newTitle="",l.titles.push(t.data))})},l.deleteTitle=function(t){o.doc.deleteTitle(t.id,function(e){e&&200===e.code&&c(l.titles,t)})},l.showDocContent=function(t){l.selectTitle=t,l.isEditDocContent=!1,o.doc.getContent(l.selectTitle.id,function(t){t&&200===t.code&&t.data?(l.docContent=t.data,l.hasDocContent=!0):(l.docContent={},l.hasDocContent=!1)})},l.toEditDocContent=function(){l.isEditDocContent=!0,console.log(l.isEditDocContent),l.hasDocContent&&(l.editContent=l.docContent.content)},l.cancelEditDocContent=function(){l.isEidtDocConent=!1,l.editContent=""},l.editDocContent=function(){if(l.docContent.content=l.editContent,l.editContent){var t,e={subjectId:l.id,titleId:l.selectTitle.id,content:l.editContent,title:l.selectTitle.title,author:"Quesle"};l.hasDocContent?(e.id=l.docContent.id,t=o.doc.putContent):t=o.doc.postContent,t(e,function(t){t&&200===t.code&&t.data&&(l.docContent=t.data,l.isEditDocContent=!1)})}},d()}])});