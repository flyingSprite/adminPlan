define(["adminApp","d3"],function(t,r){t.controller("D3ZoomSpiderWebController",function(t,e){function a(t,r,e){for(var a=t.branchs,n=t.nodes,o=[],s=0;e>s;s++)for(var i=0;r>i;i++){var c=0===s?{x:0,y:0}:n[s-1][i],p=n[s][i],h=l(c,p);o.push(h)}for(var v=n[n.length-1],i=0;r>i;i++){var c=v[i],p=a[i],h=l(c,p);o.push(h)}}function n(t){for(var r=t.nodes,e=[],a=0;a<r.length;a++){for(var n=r[a],o=n[0],s=!0,i=0;i<n.length;i++){var c=n[i];if(s)s=!1;else{var p=l(o,c);o=c,e.push(p)}}var p=l(n[0],n[n.length-1])}}function o(t){for(var r=t.nodes,e=[],a=0;a<r.length;a++)e=e.concat(r[a]);for(var n=[],a=0;a<e.length;a++){var o=s(e[a]);n.push(o)}}function s(t){var r={positition:t,point:d.append("circle").attr("class","node-dashednet").attr("cx",t.x).attr("cy",t.y).attr("r",5)};return r}function l(t,r){var e={one:t,two:r,path:d.append("polyline").attr("points",[[t.x,t.y],[r.x,r.y]])};return e}function i(t,r,e,a,n){for(var o={center:{x:0,y:0},branchs:[],nodes:[]},s=0;t>s;s++){var l=2*Math.PI/t*s,i={x:r*Math.cos(l),y:r*Math.sin(l)};o.branchs.push(i)}for(var s=0;n>s;s++){for(var c=[],p=a*s+e,h=0;t>h;h++){var l=2*Math.PI/t*h,v={x:p*Math.cos(l),y:p*Math.sin(l)};c.push(v)}o.nodes.push(c)}return o}e.title="D3",e.subTitle="Zoom Spider Web";var c=this;c.title="Zoom Spider Web",c.markTemplate="marks/d3/zoomSpiderWeb.md",c.info="在Drag Spider Web基础上，实现放大缩小的功能。";var p=r.select("#d3select").append("svg").style("width","100%").style("height","100%").style("color","#777"),h=parseInt(p.style("width").replace("px","")),v=parseInt(p.style("height").replace("px","")),d=p.append("g").attr("transform","translate("+h/2+", "+v/2+")"),f=12,u=v/2,y=40,m=30,g=(u-y)/m,x=i(f,u,y,m,g);a(x,f,g),n(x),o(x);var b=h/2,M=v/2,S=r.behavior.drag().on("drag",function(t){b+=r.event.dx,M+=r.event.dy,d.attr("transform","translate("+b+", "+M+")")});p.call(S);var W=r.behavior.zoom().scaleExtent([.1,10]).on("zoom",function(){d.attr("transform","translate("+b+", "+M+")scale("+r.event.scale+")")});p.call(W)})});